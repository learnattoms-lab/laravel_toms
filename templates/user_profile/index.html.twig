{% extends 'base.html.twig' %}

{% block title %}My Profile - Toms Music School{% endblock %}

{% block body %}
<style>
.profile-card {
    border: none;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    border-radius: 0.75rem;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
}

.profile-avatar img {
    border: 4px solid #fff;
    box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
}

.profile-avatar img:hover {
    transform: scale(1.05);
}

.profile-avatar-placeholder {
    width: 120px;
    height: 120px;
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
    border: 4px solid #fff;
    box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1);
}

.avatar-initials-large {
    font-size: 3rem;
    font-weight: 700;
    color: white;
    text-transform: uppercase;
}

.profile-stats .col-4 {
    border-right: 1px solid #e9ecef;
    padding: 1rem 0;
}

.profile-stats .col-4:last-child {
    border-right: none;
}

.profile-stats h5 {
    color: #007bff;
    font-weight: 700;
    margin-bottom: 0.25rem;
}

.card {
    border: none;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    border-radius: 0.75rem;
    transition: all 0.3s ease;
}

.card:hover {
    transform: translateY(-2px);
    box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1);
}

.card-header {
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
    color: white;
    border-bottom: none;
    border-radius: 0.75rem 0.75rem 0 0 !important;
    padding: 1.5rem;
}

.card-header h5, .card-header h6 {
    margin: 0;
    font-weight: 600;
}

.form-label {
    font-size: 0.875rem;
    font-weight: 500;
    color: #6c757d;
    margin-bottom: 0.5rem;
}

.form-control-plaintext {
    font-weight: 500;
    color: #495057;
    padding: 0.5rem 0;
    border-bottom: 1px solid #e9ecef;
}

.btn {
    border-radius: 0.5rem;
    font-weight: 500;
    transition: all 0.3s ease;
}

.btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1);
}

.badge {
    font-size: 0.875rem;
    padding: 0.5rem 1rem;
    border-radius: 1rem;
}

.quick-actions .btn {
    margin-bottom: 0.5rem;
}

.quick-actions .btn:last-child {
    margin-bottom: 0;
}

@media (max-width: 768px) {
    .profile-stats .col-4 {
        border-right: none;
        border-bottom: 1px solid #e9ecef;
        margin-bottom: 1rem;
    }
    
    .profile-stats .col-4:last-child {
        border-bottom: none;
        margin-bottom: 0;
    }
}
</style>

<div class="container mt-5">
    <div class="row">
        <!-- Profile Sidebar -->
        <div class="col-lg-4 mb-4">
            <div class="card profile-card">
                <div class="card-body text-center">
                    <div class="profile-avatar mb-3">
                        {% if app.user.profilePicture %}
                            <img src="{{ app.user.profilePicture }}" 
                                 alt="Profile Picture" 
                                 class="rounded-circle img-fluid"
                                 style="width: 120px; height: 120px; object-fit: cover;">
                        {% else %}
                            <div class="profile-avatar-placeholder">
                                <span class="avatar-initials-large">
                                    {% if app.user.firstName and app.user.lastName %}
                                        {{ app.user.firstName|first }}{{ app.user.lastName|first }}
                                    {% elseif app.user.firstName %}
                                        {{ app.user.firstName|first }}
                                    {% elseif app.user.email %}
                                        {{ app.user.email|first|upper }}
                                    {% else %}
                                        U
                                    {% endif %}
                                </span>
                                </div>
                        {% endif %}
                    </div>
                    <h4 class="card-title">{{ app.user.firstName }} {{ app.user.lastName }}</h4>
                    <p class="text-muted">{{ app.user.email }}</p>
                    
                    {% if app.user.roles|length > 0 %}
                        <span class="badge bg-primary mb-2">
                            {% if 'ROLE_ADMIN' in app.user.roles %}
                                Administrator
                            {% elseif 'ROLE_TEACHER' in app.user.roles %}
                                Music Teacher
                            {% else %}
                                Student
                            {% endif %}
                        </span>
                    {% endif %}
                    
                    <div class="profile-stats mt-3">
                        <div class="row text-center">
                            <div class="col-4">
                                <h5 class="mb-0">{{ app.user.level|default(1) }}</h5>
                                <small class="text-muted">Level</small>
                            </div>
                            <div class="col-4">
                                <h5 class="mb-0">{{ app.user.xp|default(0) }}</h5>
                                <small class="text-muted">XP</small>
                            </div>
                            <div class="col-4">
                                <h5 class="mb-0">{{ app.user.achievements|default([])|length }}</h5>
                                <small class="text-muted">Achievements</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="card mt-3">
                <div class="card-header">
                    <h6 class="mb-0"><i class="fas fa-bolt me-2"></i>Quick Actions</h6>
                </div>
                <div class="card-body">
                    <a href="{{ path('user_profile_edit') }}" class="btn btn-outline-primary btn-sm w-100 mb-2">
                        <i class="fas fa-edit me-2"></i>Edit Profile
                    </a>
                    <a href="{{ path('user_dashboard') }}" class="btn btn-outline-success btn-sm w-100 mb-2">
                        <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                    </a>
                    <a href="{{ path('user_progress') }}" class="btn btn-outline-info btn-sm w-100">
                        <i class="fas fa-chart-line me-2"></i>View Progress
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Profile Content -->
        <div class="col-lg-8">
            <!-- Personal Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-user me-2"></i>Personal Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">First Name</label>
                            <p class="form-control-plaintext">{{ app.user.firstName|default('Not provided') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Last Name</label>
                            <p class="form-control-plaintext">{{ app.user.lastName|default('Not provided') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Email</label>
                            <p class="form-control-plaintext">{{ app.user.email }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Phone</label>
                            <p class="form-control-plaintext">{{ app.user.phone|default('Not provided') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Date of Birth</label>
                            <p class="form-control-plaintext">
                                {{ app.user.dateOfBirth ? app.user.dateOfBirth|date('M d, Y') : 'Not provided' }}
                            </p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Gender</label>
                            <p class="form-control-plaintext">{{ app.user.gender|default('Not specified') }}</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Music Profile -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-music me-2"></i>Music Profile</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Primary Instrument</label>
                            <p class="form-control-plaintext">{{ app.user.primaryInstrument|default('Not specified') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Experience Level</label>
                            <p class="form-control-plaintext">{{ app.user.experienceLevel|default('Not specified') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Musical Goals</label>
                            <p class="form-control-plaintext">{{ app.user.musicalGoals|default('Not specified') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Practice Hours/Week</label>
                            <p class="form-control-plaintext">{{ app.user.practiceHoursPerWeek|default('Not specified') }}</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Academic Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-graduation-cap me-2"></i>Academic Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Current Grade/Level</label>
                            <p class="form-control-plaintext">{{ app.user.currentGrade|default('Not specified') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">School Name</label>
                            <p class="form-control-plaintext">{{ app.user.schoolName|default('Not specified') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Previous Music Experience</label>
                            <p class="form-control-plaintext">{{ app.user.previousMusicExperience|default('None') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Music Theory Knowledge</label>
                            <p class="form-control-plaintext">{{ app.user.musicTheoryKnowledge|default('Not specified') }}</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Contact & Emergency -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-address-book me-2"></i>Contact & Emergency</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Emergency Contact Name</label>
                            <p class="form-control-plaintext">{{ app.user.emergencyContactName|default('Not provided') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Emergency Contact Phone</label>
                            <p class="form-control-plaintext">{{ app.user.emergencyContactPhone|default('Not provided') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Emergency Contact Relationship</label>
                            <p class="form-control-plaintext">{{ app.user.emergencyContactRelationship|default('Not specified') }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Address</label>
                            <p class="form-control-plaintext">{{ app.user.address|default('Not provided') }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.profile-card {
    border: none;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    border-radius: 0.75rem;
}

.profile-avatar img {
    border: 4px solid #fff;
    box-shadow: 0 0.25rem 0.5rem rgba(0, 0, 0, 0.1);
}

.profile-stats .col-4 {
    border-right: 1px solid #e9ecef;
}

.profile-stats .col-4:last-child {
    border-right: none;
}

.card {
    border: none;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    border-radius: 0.75rem;
}

.card-header {
    background-color: #f8f9fa;
    border-bottom: 1px solid #e9ecef;
    border-radius: 0.75rem 0.75rem 0 0 !important;
}

.form-label {
    font-size: 0.875rem;
    font-weight: 500;
}

.form-control-plaintext {
    font-weight: 500;
    color: #495057;
}
</style>
{% endblock %}
